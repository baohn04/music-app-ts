extends ../../layouts/default.pug
include ../../mixins/alert.pug
include ../../mixins/filter-status.pug
include ../../mixins/search.pug
include ../../mixins/sort.pug
include ../../mixins/pagination.pug

block main
  if(role.permissions.includes("songs_view"))
    +alert-success(3000)
    +alert-error(3000)

    .content-wrapper
      .row
        .col-lg-12.grid-margin.stretch-card
          .card
            .card-body
              h4.card-title #{pageTitle}

              .row.mb-3
                .col-md-6
                  +filter-status(filterStatus)
                .col-md-6
                  +search(keyword)

              .row.mb-3
                .col-md-4
                  +sort()

              .row.mb-3
                .col-12(style="text-align: right;")
                  if(role.permissions.includes("songs_create")) 
                    a(
                      href=`${prefixAdmin}/songs/create`
                      class="btn btn-success"
                    ) + Thêm mới

              .table-responsive
                table(
                  class="table table-hover"
                  checkbox-multi
                ) 
                  thead 
                    tr 
                      th STT
                      th Hình ảnh
                      th Tiêu đề
                      th Ca sĩ
                      th Chủ đề
                      th Vị trí 
                      th Trạng thái
                      th Hành động

                  tbody
                    each item, index in songs 
                      tr 
                        td #{index + 1}
                        td 
                          img(
                            src=item.avatar 
                            alt=item.title
                            width="100px"
                            height="auto"
                          )
                        td #{item.title}
                        td #{item.infoSinger.fullName}
                        td #{item.infoTopic.title}
                        td #{item.position}
                        td
                          if(role.permissions.includes("songs_edit"))
                            if(item.status == "active")
                              a(
                                href="javascript:;"
                                data-id=item.id
                                data-status=item.status
                                button-change-status 
                                class="badge badge-success"
                              ) Hoạt động
                            else 
                              a(
                                href="javascript:;"
                                data-id=item.id
                                data-status=item.status
                                button-change-status
                                class="badge badge-danger"
                              ) Dừng hoạt động
                        td
                          if(role.permissions.includes("songs_edit"))
                            a(
                              href=`${prefixAdmin}/songs/edit/${item.id}`
                              class="btn btn-warning btn-sm"
                            ) Sửa 
                          a(
                            href=`${prefixAdmin}/songs/detail/${item.id}`
                            class="btn btn-secondary btn-sm"
                          ) Chi tiết
                          if(role.permissions.includes("songs_delete"))
                            button(
                              class="btn btn-danger btn-sm"
                              button-delete
                              data-id=item.id
                            ) Xóa

              +pagination(pagination)

              form(
                action=""
                method="POST"
                id="form-delete-item"
                data-path=`${prefixAdmin}/songs/delete`
              )

              form(
                action=""
                method="POST"
                id="form-change-status"
                data-path=`${prefixAdmin}/songs/change-status`
              )
  else 
    h1 Bạn không có quyền truy cập vào trang này